<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
    <!-- 插件id -->
    <id>cn.wx1998.kmerit.jetbrains.plugins.quickmybatis</id>
    <!-- 插件名称 -->
    <name>Km-Quick-Mybatis</name>
    <!-- 作者 -->
    <vendor>wx98</vendor>
    <!-- 依赖 -->
    <depends>com.intellij.java</depends>
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.xml</depends>
    <!-- 资源包 -->
    <resource-bundle>messages.MyBundle</resource-bundle>
    <!-- 监听器 -->
    <applicationListeners>
        <listener
                topic="com.intellij.openapi.application.ApplicationActivationListener"
                class="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.listeners.MyApplicationActivationListener"
        />
    </applicationListeners>
    <!-- Action -->
    <actions>
        <!-- 注册刷新动作 -->
        <action id="QuickMyBatis.RefreshCache"
                class="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.actions.RefreshMyBatisCacheAction"
                text="刷新MyBatis缓存"
                description="刷新所有MyBatis相关缓存">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt R"/>
        </action>

        <!-- 一级根菜单 - km-quick-mybatis -->
        <group id="KmQuickMyBatis.RootGroup"
               class="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.actions.popup.root.KmQuickMyBatisRootGroup"
               text="km-quick-mybatis"
               description="km-quick-mybatis 快捷工具">
            <!-- 挂载到编辑器右键 + 项目视图右键 -->
            <add-to-group group-id="EditorPopupMenu" anchor="first"/>
            <add-to-group group-id="ProjectViewPopupMenu" anchor="last"/>
        </group>

        <!-- 一级子项 - 添加方法-->
        <!-- <action id="KmQuickMyBatis.AddMethod"-->
        <!--         class="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.actions.popup.root.leve1.AddMethodAction"-->
        <!--         text="添加方法"-->
        <!--         description="添加MyBatis映射方法">-->
        <!--     <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt A"/>-->
        <!-- </action>-->

        <!--  二级子菜单 - 刷新 -->
        <group id="KmQuickMyBatis.RefreshGroup"
               class="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.actions.popup.root.leve1.leve2.RefreshActionGroup"
               text="刷新"
               description="刷新MyBatis缓存相关操作">
            <!-- 无需挂载到外部分组，由根菜单管理 -->
        </group>

        <!-- 二级子项 - 刷新所有缓存-->
        <action id="KmQuickMyBatis.RefreshAllCache"
                class="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.actions.popup.root.leve1.leve2.RefreshAllCacheAction"
                text="刷新所有缓存"
                description="刷新所有MyBatis缓存">
        </action>

        <!-- 二级子项 - 刷新Xml文件缓存 -->
        <action id="KmQuickMyBatis.RefreshXmlCache"
                class="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.actions.popup.root.leve1.leve2.RefreshXmlCacheAction"
                text="刷新Xml文件缓存"
                description="刷新MyBatis XML文件缓存">
        </action>

        <!-- 二级子项 - 刷新Java文件缓存 -->
        <action id="KmQuickMyBatis.RefreshJavaFileCache"
                class="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.actions.popup.root.leve1.leve2.RefreshJavaFileCacheAction"
                text="刷新Java文件缓存"
                description="刷新MyBatis Java文件缓存">
        </action>

        <!-- 二级子项 - 刷新Java方法调用缓存 -->
        <action id="KmQuickMyBatis.RefreshJavaMethodCache"
                class="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.actions.popup.root.leve1.leve2.RefreshJavaMethodCacheAction"
                text="刷新Java方法调用缓存"
                description="刷新MyBatis Java方法调用缓存">
        </action>
    </actions>
    <!-- 扩展点 -->
    <extensions defaultExtensionNs="com.intellij">
        <projectService
                id="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.services.JavaService"
                serviceImplementation="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.services.JavaService"
        />
        <projectService
                id="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.services.XmlService"
                serviceImplementation="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.services.XmlService"
        />
        <projectService
                id="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.util.NotificationUtil$NotificationSettings"
                serviceImplementation="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.util.NotificationUtil$NotificationSettings"
        />
        <projectService
                id="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.util.DataBaseManager"
                serviceImplementation="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.util.DataBaseManager"
        />

        <!-- java 跳转到 xml   -->
        <codeInsight.lineMarkerProvider
                id="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.provider.JavaLineMarkerProvider"
                language="JAVA"
                implementationClass="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.provider.JavaLineMarkerProvider"
        />
        <!-- xml 跳转到 java -->
        <codeInsight.lineMarkerProvider
                id="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.provider.XmlLineMarkerProvider"
                language="XML"
                implementationClass="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.provider.XmlLineMarkerProvider"
        />
        <!-- 插件的配置 -->
        <applicationService
                id="cn.wx1998.MyPluginSettings"
                serviceImplementation="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.setting.MyPluginSettings"
        />
        <!-- 插件配置 -->
        <applicationConfigurable
                id="cn.wx1998.MyPluginConfigurable"
                displayName="Km-Quick-Mybatis"
                parentId="tools"
                instance="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.setting.MyPluginConfigurable"
        />
        <!-- 缓存管理器服务 -->
        <projectService
                id="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.cache.MyBatisCacheManagerDefault"
                serviceImplementation="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.cache.MyBatisCacheManagerDefault"
        />
        <!-- 插件配置类 -->
        <projectService
                id="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.setting.MyBatisSetting"
                serviceImplementation="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.setting.MyBatisSetting"
        />
        <!-- 项目启动时触发 -->
        <postStartupActivity
                implementation="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.cache.persistent.MyBatisCacheStartupLoader"/>

        <!-- 项目关闭时触发 -->
        <projectCloseHandler
                implementation="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.cache.persistent.MyBatisCacheCloseSaver"/>

        <!-- 插件通知组-->
        <notificationGroup
                displayType="BALLOON"
                id="cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.util.NotificationUtil"
                isLogByDefault="true"
                bundle="messages.MyBundle"
                key="notification.group.cn.wx1998.kmerit.jetbrains.plugins.quickmybatis.util.NotificationUtil"/>
    </extensions>
</idea-plugin>
